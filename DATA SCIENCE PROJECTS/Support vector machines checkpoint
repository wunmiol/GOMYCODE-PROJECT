{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"e73laWuV2lzk"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from scipy.stats import zscore\n","from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\n","from sklearn import svm\n","from sklearn.svm import SVR\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import confusion_matrix\n","from sklearn.metrics import accuracy_score\n","from sklearn.model_selection import GridSearchCV\n","from mlxtend.plotting import plot_decision_regions\n","from sklearn.preprocessing import StandardScaler, LabelEncoder\n","from sklearn.preprocessing import OneHotEncoder"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fZovbSOswvJr"},"outputs":[],"source":["dataset = pd.read_csv('/content/Electric_cars_dataset.csv')"]},{"cell_type":"markdown","metadata":{"id":"KyzUuZ1u9HVP"},"source":["**EXPLORING THE DATA**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":590},"collapsed":true,"executionInfo":{"elapsed":943,"status":"ok","timestamp":1721187719209,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"9Bvhj8HzyC2h","outputId":"14fa118b-afd0-4aa4-ba7f-45b34c46c150"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"summary":"{\n  \"name\": \"dataset\",\n  \"rows\": 64353,\n  \"fields\": [\n    {\n      \"column\": \"ID\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 64353,\n        \"samples\": [\n          \"EV45181\",\n          \"EV69055\",\n          \"EV60667\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"VIN (1-10)\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 5644,\n        \"samples\": [\n          \"WA1LABGE2N\",\n          \"5YJSA1AC3D\",\n          \"WBY1Z8C52H\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"County\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 139,\n        \"samples\": [\n          \"Albemarle\",\n          \"Newport\",\n          \"Marin\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"City\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 544,\n        \"samples\": [\n          \"ELECTRIC CITY\",\n          \"TOPPENISH\",\n          \"PALOUSE\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"State\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 38,\n        \"samples\": [\n          \"MT\",\n          \"WI\",\n          \"IL\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ZIP Code\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2856.0643293673843,\n        \"min\": 745.0,\n        \"max\": 99701.0,\n        \"num_unique_values\": 678,\n        \"samples\": [\n          78154.0,\n          98002.0,\n          98604.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Model Year\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2.7267416763887606,\n        \"min\": 1993.0,\n        \"max\": 2022.0,\n        \"num_unique_values\": 19,\n        \"samples\": [\n          2020.0,\n          2016.0,\n          2012.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Make\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 34,\n        \"samples\": [\n          \"HONDA\",\n          \"FIAT\",\n          \"DODGE\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Model\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 107,\n        \"samples\": [\n          \"530E XDRIVE\",\n          \"RANGE ROVER SPORT\",\n          \"BOLT EV\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Electric Vehicle Type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"Plug-in Hybrid Electric Vehicle (PHEV)\",\n          \"Battery Electric Vehicle (BEV)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Clean Alternative Fuel Vehicle (CAFV) Eligibility\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"Clean Alternative Fuel Vehicle Eligible\",\n          \"Not eligible due to low battery range\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Electric Range\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 104,\n        \"min\": 0,\n        \"max\": 337,\n        \"num_unique_values\": 98,\n        \"samples\": [\n          20,\n          200\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Base MSRP\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 12402,\n        \"min\": 0,\n        \"max\": 845000,\n        \"num_unique_values\": 37,\n        \"samples\": [\n          32250,\n          64950\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Legislative District\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 14.661123626483931,\n        \"min\": 0.0,\n        \"max\": 49.0,\n        \"num_unique_values\": 50,\n        \"samples\": [\n          21.0,\n          16.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"DOL Vehicle ID\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 106946647,\n        \"min\": 4385,\n        \"max\": 478934571,\n        \"num_unique_values\": 64353,\n        \"samples\": [\n          166559368,\n          3595182\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Vehicle Location\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 668,\n        \"samples\": [\n          \"POINT (-121.618012 47.823355)\",\n          \"POINT (-122.02812 47.393554)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Electric Utility\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 68,\n        \"samples\": [\n          \"BONNEVILLE POWER ADMINISTRATION||PUD NO 1 OF CLALLAM COUNTY|PUD NO 1 OF JEFFERSON COUNTY\",\n          \"AVISTA CORP\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Expected Price ($1k)\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 210,\n        \"samples\": [\n          \"38\",\n          \"102.4\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}","type":"dataframe","variable_name":"dataset"},"text/html":["\n","  <div id=\"df-5a532cfa-aeb8-4bab-bcf3-4ecc2bdd8b35\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>VIN (1-10)</th>\n","      <th>County</th>\n","      <th>City</th>\n","      <th>State</th>\n","      <th>ZIP Code</th>\n","      <th>Model Year</th>\n","      <th>Make</th>\n","      <th>Model</th>\n","      <th>Electric Vehicle Type</th>\n","      <th>Clean Alternative Fuel Vehicle (CAFV) Eligibility</th>\n","      <th>Electric Range</th>\n","      <th>Base MSRP</th>\n","      <th>Legislative District</th>\n","      <th>DOL Vehicle ID</th>\n","      <th>Vehicle Location</th>\n","      <th>Electric Utility</th>\n","      <th>Expected Price ($1k)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>EV33174</td>\n","      <td>5YJ3E1EC6L</td>\n","      <td>Snohomish</td>\n","      <td>LYNNWOOD</td>\n","      <td>WA</td>\n","      <td>98037.0</td>\n","      <td>2020.0</td>\n","      <td>TESLA</td>\n","      <td>MODEL 3</td>\n","      <td>Battery Electric Vehicle (BEV)</td>\n","      <td>Clean Alternative Fuel Vehicle Eligible</td>\n","      <td>308</td>\n","      <td>0</td>\n","      <td>32.0</td>\n","      <td>109821694</td>\n","      <td>POINT (-122.287614 47.83874)</td>\n","      <td>PUGET SOUND ENERGY INC</td>\n","      <td>50</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>EV40247</td>\n","      <td>JN1AZ0CP8B</td>\n","      <td>Skagit</td>\n","      <td>BELLINGHAM</td>\n","      <td>WA</td>\n","      <td>98229.0</td>\n","      <td>2011.0</td>\n","      <td>NISSAN</td>\n","      <td>LEAF</td>\n","      <td>Battery Electric Vehicle (BEV)</td>\n","      <td>Clean Alternative Fuel Vehicle Eligible</td>\n","      <td>73</td>\n","      <td>0</td>\n","      <td>40.0</td>\n","      <td>137375528</td>\n","      <td>POINT (-122.414936 48.709388)</td>\n","      <td>PUGET SOUND ENERGY INC</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>EV12248</td>\n","      <td>WBY1Z2C56F</td>\n","      <td>Pierce</td>\n","      <td>TACOMA</td>\n","      <td>WA</td>\n","      <td>98422.0</td>\n","      <td>2015.0</td>\n","      <td>BMW</td>\n","      <td>I3</td>\n","      <td>Battery Electric Vehicle (BEV)</td>\n","      <td>Clean Alternative Fuel Vehicle Eligible</td>\n","      <td>81</td>\n","      <td>0</td>\n","      <td>27.0</td>\n","      <td>150627382</td>\n","      <td>POINT (-122.396286 47.293138)</td>\n","      <td>BONNEVILLE POWER ADMINISTRATION||CITY OF TACOM...</td>\n","      <td>18</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>EV55713</td>\n","      <td>1G1RD6E44D</td>\n","      <td>King</td>\n","      <td>REDMOND</td>\n","      <td>WA</td>\n","      <td>98053.0</td>\n","      <td>2013.0</td>\n","      <td>CHEVROLET</td>\n","      <td>VOLT</td>\n","      <td>Plug-in Hybrid Electric Vehicle (PHEV)</td>\n","      <td>Clean Alternative Fuel Vehicle Eligible</td>\n","      <td>38</td>\n","      <td>0</td>\n","      <td>45.0</td>\n","      <td>258766301</td>\n","      <td>POINT (-122.024951 47.670286)</td>\n","      <td>PUGET SOUND ENERGY INC||CITY OF TACOMA - (WA)</td>\n","      <td>33.9</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>EV28799</td>\n","      <td>1G1FY6S05K</td>\n","      <td>Pierce</td>\n","      <td>PUYALLUP</td>\n","      <td>WA</td>\n","      <td>98375.0</td>\n","      <td>2019.0</td>\n","      <td>CHEVROLET</td>\n","      <td>BOLT EV</td>\n","      <td>Battery Electric Vehicle (BEV)</td>\n","      <td>Clean Alternative Fuel Vehicle Eligible</td>\n","      <td>238</td>\n","      <td>0</td>\n","      <td>25.0</td>\n","      <td>296998138</td>\n","      <td>POINT (-122.321062 47.103797)</td>\n","      <td>BONNEVILLE POWER ADMINISTRATION||CITY OF TACOM...</td>\n","      <td>41.78</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5a532cfa-aeb8-4bab-bcf3-4ecc2bdd8b35')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5a532cfa-aeb8-4bab-bcf3-4ecc2bdd8b35 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5a532cfa-aeb8-4bab-bcf3-4ecc2bdd8b35');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-e8a0973e-c8d4-433a-9de8-b06a99783aee\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e8a0973e-c8d4-433a-9de8-b06a99783aee')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-e8a0973e-c8d4-433a-9de8-b06a99783aee button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["        ID  VIN (1-10)     County        City State  ZIP Code  Model Year  \\\n","0  EV33174  5YJ3E1EC6L  Snohomish    LYNNWOOD    WA   98037.0      2020.0   \n","1  EV40247  JN1AZ0CP8B     Skagit  BELLINGHAM    WA   98229.0      2011.0   \n","2  EV12248  WBY1Z2C56F     Pierce      TACOMA    WA   98422.0      2015.0   \n","3  EV55713  1G1RD6E44D       King     REDMOND    WA   98053.0      2013.0   \n","4  EV28799  1G1FY6S05K     Pierce    PUYALLUP    WA   98375.0      2019.0   \n","\n","        Make    Model                   Electric Vehicle Type  \\\n","0      TESLA  MODEL 3          Battery Electric Vehicle (BEV)   \n","1     NISSAN     LEAF          Battery Electric Vehicle (BEV)   \n","2        BMW       I3          Battery Electric Vehicle (BEV)   \n","3  CHEVROLET     VOLT  Plug-in Hybrid Electric Vehicle (PHEV)   \n","4  CHEVROLET  BOLT EV          Battery Electric Vehicle (BEV)   \n","\n","  Clean Alternative Fuel Vehicle (CAFV) Eligibility  Electric Range  \\\n","0           Clean Alternative Fuel Vehicle Eligible             308   \n","1           Clean Alternative Fuel Vehicle Eligible              73   \n","2           Clean Alternative Fuel Vehicle Eligible              81   \n","3           Clean Alternative Fuel Vehicle Eligible              38   \n","4           Clean Alternative Fuel Vehicle Eligible             238   \n","\n","   Base MSRP  Legislative District  DOL Vehicle ID  \\\n","0          0                  32.0       109821694   \n","1          0                  40.0       137375528   \n","2          0                  27.0       150627382   \n","3          0                  45.0       258766301   \n","4          0                  25.0       296998138   \n","\n","                Vehicle Location  \\\n","0   POINT (-122.287614 47.83874)   \n","1  POINT (-122.414936 48.709388)   \n","2  POINT (-122.396286 47.293138)   \n","3  POINT (-122.024951 47.670286)   \n","4  POINT (-122.321062 47.103797)   \n","\n","                                    Electric Utility Expected Price ($1k)  \n","0                             PUGET SOUND ENERGY INC                   50  \n","1                             PUGET SOUND ENERGY INC                   15  \n","2  BONNEVILLE POWER ADMINISTRATION||CITY OF TACOM...                   18  \n","3      PUGET SOUND ENERGY INC||CITY OF TACOMA - (WA)                 33.9  \n","4  BONNEVILLE POWER ADMINISTRATION||CITY OF TACOM...                41.78  "]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["dataset.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":371,"status":"ok","timestamp":1721187754023,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"225Fu9vLyNTt","outputId":"a85571df-2749-4270-d14f-ebbefc374165"},"outputs":[{"data":{"text/plain":["0"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["dataset.duplicated().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":372,"status":"ok","timestamp":1721190427784,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"onmNc_NAyNNn","outputId":"3182f16c-66cd-47a1-cca1-29c3500710a6"},"outputs":[{"data":{"text/plain":["ID                                                   0\n","VIN (1-10)                                           0\n","County                                               0\n","City                                                 0\n","State                                                0\n","ZIP Code                                             0\n","Model Year                                           0\n","Make                                                 0\n","Model                                                0\n","Electric Vehicle Type                                0\n","Clean Alternative Fuel Vehicle (CAFV) Eligibility    0\n","Electric Range                                       0\n","Base MSRP                                            0\n","Legislative District                                 0\n","DOL Vehicle ID                                       0\n","Vehicle Location                                     0\n","Electric Utility                                     0\n","Expected Price ($1k)                                 0\n","dtype: int64"]},"execution_count":43,"metadata":{},"output_type":"execute_result"}],"source":["dataset.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":376,"status":"ok","timestamp":1721188657785,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"aUPB3W3j0-Rr","outputId":"1e366ad1-fc6c-4b8f-ad6d-bf2a6673a4e8"},"outputs":[{"name":"stdout","output_type":"stream","text":["(64353, 18)\n"]}],"source":["print(dataset.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0tv26Jvp1Yv8"},"outputs":[],"source":["dataset = dataset.drop(columns=['ID','VIN (1-10)', 'County',  'City', 'State', 'DOL Vehicle ID'])\n"]},{"cell_type":"markdown","metadata":{"id":"zXP1Z1AK9BKh"},"source":["**HANDLING OUTLIERS**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":380,"status":"ok","timestamp":1721188571938,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"U7wJpIYmyNIh","outputId":"593687c9-d87b-460a-e9a4-e992c11f4917"},"outputs":[{"name":"stdout","output_type":"stream","text":["(0, 18)\n"]}],"source":["# Calculate Z-scores of numeric columns\n","z_scores = np.abs(zscore(dataset.select_dtypes(include=[np.number])))\n","\n","# Filter out rows with Z-score greater than 3\n","dataset = dataset[(z_scores < 3).all(axis=1)]\n","\n","# Verify the shape of the dataset after removing outliers\n","print(dataset.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jjNOeOfc1aYO"},"outputs":[],"source":["# Handle outliers (example using IQR)\n","Q1 = dataset.select_dtypes(include=['number']).quantile(0.25)\n","Q3 = dataset.select_dtypes(include=['number']).quantile(0.75)\n","IQR = Q3 - Q1\n","dataset = dataset[~((dataset.select_dtypes(include=['number']) < (Q1 - 1.5 * IQR)) | (dataset.select_dtypes(include=['number']) > (Q3 + 1.5 * IQR)))]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":401,"status":"ok","timestamp":1721192252253,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"Th7PBFvX2V3G","outputId":"399022d8-3eaf-4307-fcdd-d1c126edf195"},"outputs":[{"name":"stdout","output_type":"stream","text":["(64353, 18)\n"]}],"source":["print(dataset.shape)"]},{"cell_type":"markdown","metadata":{"id":"odpbYWZs83Wq"},"source":["**HANDLING MISSING VALUES**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ml1N1BFm2n2r"},"outputs":[],"source":["# Select columns with object data types\n","categorical_cols = dataset.select_dtypes(include=['object'])\n","\n","# Fill missing values in each categorical column with the mode\n","for col in categorical_cols:\n","    dataset[col].fillna(dataset[col].mode()[0], inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ApipHDv_2npL"},"outputs":[],"source":["dataset['Model Year'].fillna(dataset['Model Year'].median(), inplace=True)\n","dataset['ZIP Code'].fillna(dataset['ZIP Code'].mode()[0], inplace=True)\n","dataset['Legislative District'].fillna(dataset['Legislative District'].mode()[0], inplace=True)\n","\n"]},{"cell_type":"markdown","metadata":{"id":"twhyDuxt1Ivd"},"source":["**ENCODING**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"executionInfo":{"elapsed":406,"status":"ok","timestamp":1721247081853,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"b_mnSVPkwZ1W","outputId":"6159350d-3cdd-436d-ea47-89c6c84c29c8"},"outputs":[{"name":"stdout","output_type":"stream","text":["   ZIP Code  Model Year  Make  Model  Electric Vehicle Type  \\\n","0   98037.0      2020.0    28     57                      0   \n","1   98229.0      2011.0    22     53                      0   \n","2   98422.0      2015.0     3     45                      0   \n","3   98053.0      2013.0     5     96                      1   \n","4   98375.0      2019.0     5     15                      0   \n","\n","   Clean Alternative Fuel Vehicle (CAFV) Eligibility  Electric Range  \\\n","0                                                  0             308   \n","1                                                  0              73   \n","2                                                  0              81   \n","3                                                  0              38   \n","4                                                  0             238   \n","\n","   Base MSRP  Legislative District  Vehicle Location  Electric Utility  \\\n","0          0                  32.0               318                65   \n","1          0                  40.0               380                65   \n","2          0                  27.0               372                20   \n","3          0                  45.0               245                66   \n","4          0                  25.0               338                16   \n","\n","   Expected Price ($1k)  \n","0                   154  \n","1                    27  \n","2                    40  \n","3                   115  \n","4                   136  \n"]}],"source":["# Encode categorical features\n","categorical_features = dataset.select_dtypes('object').columns\n","label_encoders = {}\n","for col in categorical_features:\n","    le = LabelEncoder()\n","    dataset[col] = le.fit_transform(dataset[col])\n","    label_encoders[col] = le\n","\n","# Verify encoding\n","print(dataset.head())"]},{"cell_type":"markdown","metadata":{"id":"6bbBF-LX1d7T"},"source":["\n","**SELECTION OF TARGET VARIABLES AND FEATURES**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1721247092637,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"8Q1E0DIE_URZ","outputId":"a1328e9a-1330-4ad4-a5c2-aa8d82981ed2"},"outputs":[{"name":"stdout","output_type":"stream","text":["(64353, 11) (64353,)\n"]}],"source":["\n","x = dataset.drop(columns=['Expected Price ($1k)'])\n","y = dataset['Expected Price ($1k)']\n","\n","# Verify the shapes of X and y\n","print(x.shape, y.shape)"]},{"cell_type":"markdown","metadata":{"id":"iTP_5KdX16GW"},"source":["**SPLITTING OF THE DATASET AND STANDARDIZING**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0lcX7NwpImRR"},"outputs":[],"source":["# Split the dataset into training and test sets\n","xtrain, xtest, ytrain, ytest = train_test_split(x, y, test_size=0.2, random_state=42)\n","\n","# Standardize the data (fit on training set and transform both training and test sets)\n","scaler = StandardScaler()\n","xtrain = scaler.fit_transform(xtrain)\n","xtest = scaler.transform(xtest)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VvyP1urM_IqC"},"outputs":[],"source":["# Train SVM\n","svr_model = SVR(kernel='rbf', C=1.0, epsilon=0.1)"]},{"cell_type":"markdown","metadata":{"id":"AEBEvmaH2Eq8"},"source":["**TRAINING WITH SVM-SUPPORT VECTOR REGRESSOR**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":74},"executionInfo":{"elapsed":165191,"status":"ok","timestamp":1721208423952,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"qYWhc7ozz6vx","outputId":"de80e67c-3614-41af-86fb-03c28b5caca8"},"outputs":[{"data":{"text/html":["<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-3\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SVR()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" checked><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVR</label><div class=\"sk-toggleable__content\"><pre>SVR()</pre></div></div></div></div></div>"],"text/plain":["SVR()"]},"execution_count":42,"metadata":{},"output_type":"execute_result"}],"source":["# Train SVM\n","svr_model = SVR(kernel='rbf')\n","svr_model.fit(xtrain, ytrain)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_mNexJX0z6kL"},"outputs":[],"source":["# Prediction\n","y_pred = svr_model.predict(xtest)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":475,"status":"ok","timestamp":1721208956431,"user":{"displayName":"Adewunmi Pelumi","userId":"06710081251634332367"},"user_tz":-60},"id":"veXNOZ8xz6Xv","outputId":"0751b765-cbdd-4a9b-ecb0-bf930dc8755c"},"outputs":[{"name":"stdout","output_type":"stream","text":["MAE: 16.55555480121683, MSE: 1100.652701083758, R2: 0.6726464836293572\n"]}],"source":["# Calculate evaluation metrics\n","mae = mean_absolute_error(ytest, y_pred)\n","mse = mean_squared_error(ytest, y_pred)\n","r2 = r2_score(ytest, y_pred)\n","print(f\"MAE: {mae}, MSE: {mse}, R2: {r2}\")"]},{"cell_type":"markdown","metadata":{"id":"vmTKvaN8ETz8"},"source":["**GRID SEARCH CV**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"8uTlZQ5hETWL","outputId":"6965d949-aa51-4c57-bd99-d108cd9f9a7f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Fitting 5 folds for each of 18 candidates, totalling 90 fits\n","[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time= 2.2min\n","[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time= 2.1min\n","[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time= 2.0min\n","[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time= 2.1min\n","[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time= 2.0min\n"]}],"source":["# Define the parameter grid\n","param_grid = {\n","    'C': [0.1, 1, 2],\n","    'gamma': [ 0.1, 0.01],\n","    'kernel': ['rbf', 'poly']\n","}\n","\n","# Initialize the Grid Search\n","grid = GridSearchCV(SVR(), param_grid, refit=True, verbose=2, cv=5)\n","\n","# Fit the Grid Search to the data\n","grid.fit(xtrain, ytrain)\n","\n","# Print the best parameters and the best estimator\n","print(grid.best_params_)\n","print(grid.best_estimator_)\n","\n","# Predict using the best model\n","y_pred = grid.predict(xtest)\n","\n","# Calculate evaluation metrics\n","mae = mean_absolute_error(ytest, y_pred)\n","mse = mean_squared_error(ytest, y_pred)\n","r2 = r2_score(ytest, y_pred)\n","\n","print(f\"MAE: {mae}, MSE: {mse}, R2: {r2}\")\n"]}],"metadata":{"colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}